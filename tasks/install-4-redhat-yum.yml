---
# https://snapcraft.io/docs/installing-snap-on-centos
- name: Add EPEL repo
  when:
    - ansible_os_family == 'RedHat'
    - ansible_pkg_mgr == 'yum'
  vars:
    # https://stackoverflow.com/a/47091066/5430535
    # https://github.com/ansible/ansible/issues/32532#issuecomment-341641007
    ansible_python_interpreter: /usr/bin/python2.7
  become: yes
  # https://fedoraproject.org/wiki/EPEL
  yum:
    name:
      - https://dl.fedoraproject.org/pub/epel/epel-release-latest-{{ ansible_distribution_major_version }}.noarch.rpm
    state: present

- name: Install snapd and config service 4 enterprise RHEL-like
  when:
    - ansible_os_family == 'RedHat'
    - ansible_pkg_mgr == 'yum'
  become: yes
  vars:
    ansible_python_interpreter: /usr/bin/python2.7
  yum:
    name:
      - snapd
    state: present
  notify:
    - start-snapd-socket
